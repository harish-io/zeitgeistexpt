function doCleanPlot(){for(var a=0;a<plots.length;a++){stage.removeChild(plots[a])}for(var a=0;a<plots.length;a++){var b=plots[a].clip;stage.addChild(b)}}function plotLines(){g.setStrokeStyle(2);g.beginStroke(Graphics.getRGB(249,225,142));for(var a=0;a<plots.length;a++){if(plots[a].clip.y>0){g.lineTo(plots[a].clip.x+8,plots[a].clip.y+7)}}doCleanPlot();g.endStroke()}function traceLocations(){for(var a=0;a<plots.length;a++){g.lineTo(plots[a].clip.x+8,plots[a].clip.y+7)}}function dropPlotPoints(){plottingComplete=false;for(var a=0;a<plots.length;a++){Tween.get(plots[a].clip).to({x:plots[a].clip.x,y:plots[a].toPos},100*(Math.random()+a)).call(onComplete)}plottingComplete=true}function drawLines(){g=new Graphics;g.setStrokeStyle(2);g.beginStroke(Graphics.getRGB(249,225,142));var a=new Shape(g);a.width=560;a.height=420;stage.addChild(a)}function onHide(a){hideCounter++;$("#w1").removeClass("animateDown");$("#w2").removeClass("animateDown");$("#w3").removeClass("animateDown");$("#w4").removeClass("animateDown");$("#w1").addClass("resetLabelPos");$("#w2").addClass("resetLabelPos");$("#w3").addClass("resetLabelPos");$("#w4").addClass("resetLabelPos")}function onEnd(a){$("#chartHolder").removeClass("animateLeft");$("#chartHolder").removeClass("animateRight")}function hideLabels(){$("#w1").addClass("animateDown");$("#w2").addClass("animateDown");$("#w3").addClass("animateDown");$("#w4").addClass("animateDown");w1.addEventListener("webkitTransitionEnd",onHide);w2.addEventListener("webkitTransitionEnd",onHide);w3.addEventListener("webkitTransitionEnd",onHide);w4.addEventListener("webkitTransitionEnd",onHide)}function createDummyPlotPositions(){g.clear();for(var a=0;a<plots.length;a++){plots[a].toPos=tempYOffset-Math.round(Math.random()*100)}}function doTopIndexCalculation(){var a=new Array;for(var b=0;b<scaledObjects.length;b++){a.push(scaledObjects[b])}a.sort(compare);for(var c=0;c<scaledObjects.length;c++){if(scaledObjects[c].toScale==a[a.length-1].toScale){topIndex=c;break}}}function doScroll(a){tweenCompleted=false;animateBackground(a);hideLabels();createDummyChartCoordinates();createDummyPlotPositions();dropPlotPoints();tweenCounter=0}function createDummyChartCoordinates(){for(var a=0;a<scaledObjects.length;a++){var b=Math.round(Math.random()*10)*3;scaledObjects[a].toScale=b}}function animateBackground(a){chartHolder.addEventListener("webkitTransitionEnd",onEnd);if(a==0){$("#chartHolder").addClass("animateLeft")}else if(a==1){$("#chartHolder").addClass("animateRight")}}function getRealData(){for(var a=0;a<plots.length;a++){plots[a].toPos=tempYOffset-Math.round(Math.random()*100)}dropPlotPoints()}function onComplete(){tweenCounter++;if(tweenCounter==16){doCleanPlot();if(firstDrop){getRealData();firstDrop=false}}}function tick(){for(var a=0;a<scaledObjects.length;a++){var b=scaledObjects[a].clip;toScale=scaledObjects[a].toScale;var c=caps[a];$("#ribbedDiv").regY=graphItemRegY;b.regY=graphItemRegY;var d=b.scaleY;var e=d*scalingItemHeight;if(b.scaleY<toScale){b.scaleY+=.5;c.y=bottomPosition-d*scalingItemHeight}else if(b.scaleY>toScale){b.scaleY-=.5;c.y=bottomPosition-d*scalingItemHeight}}if(plottingComplete){g.clear();g.setStrokeStyle(2);g.beginStroke(Graphics.getRGB(249,225,142));traceLocations()}stage.update()}function compare(a,b){return a.toScale-b.toScale}function addChartItems(){var a=new Array;for(var b=0;b<items.length;b++){a.push(items[b])}a.sort(compare);for(var c=0;c<items.length;c++){if(items[c].toScale==a[a.length-1].toScale){topIndex=c;break}}for(var d=0;d<items.length;d++){var e;if(d%2==0){xPosition+=offsetGutter}e=xPosition-capAdjust;if(d==topIndex){newIndex=d}var f=new Image;f.src="img/volbarbottom.png";bmp=new Bitmap(f);stage.addChild(bmp);bmp.y=bottomPosition;bmp.x=xPosition;var g=new Image;g.src="img/scaleclip.png";bmp=new Bitmap(g);stage.addChild(bmp);scalingClip=bmp;bmp.y=bottomPosition;bmp.x=xPosition;scaledObjects.push({clip:scalingClip,toScale:items[d].toScale});var h=new Image;h.src="img/cap.png";bmp=new Bitmap(h);bmp.x=e;cap=bmp;caps.push(cap);stage.addChild(bmp);var i=new Image;i.src="img/plot.png";bmp=new Bitmap(i);stage.addChild(bmp);bmp.x=xPosition+5;bmp.y=plotStartYPos;plots.push({clip:bmp,toPos:320});stage.update();plotStartYPos-=40;xPosition=xPosition+graphItemWidth}}function addChartLabels(){topIndex=Math.round(Math.random()*10);for(var a=0;a<5;a++){var b=new Text(chartLabelTop.toString(),"Droid Sans","#DDDDDD");b.y=chartLabelYPosition;b.x=chartLabelXPosition;stage.addChild(b);chartLabelTop-=20;chartLabelYPosition+=gridGutter}}function init(){canvas=document.getElementById("canvas");var a=$("#chartHolder");canvas.width=a.width();canvas.height=a.height();stage=new Stage(canvas);Ticker.setFPS(60);Ticker.addListener(window);addChartLabels();for(var b=0;b<16;b++){items.push({val:"item"+b,toScale:Math.round(Math.random()*10)*3})}addChartItems();drawLines();dropPlotPoints()}$(document).ready(function(a){init()});var canvas;var stage;var bmp;var ctx;var foot;var scalingClip;var cap;var scaledObjects=new Array;var caps=new Array;var xPosition=2;var bottomPosition=315;var offsetGutter=3;var capAdjust=1;var graphItemWidth=30;var graphItemRegY=6.7;var scalingItemHeight=7;var chartLabelTop=100;var chartLabelXPosition=508;var chartLabelYPosition=10;var gridGutter=60;var ribbedProps;var items=new Array;var plots=new Array;var plottingComplete=false;var topIndex;var plotStartYPos=0;var toScale=10;var scalingDone=false;var g;var tickcount=0;var tweenCompleted=false;var tweenCounter=0;var currentPlot;var plotindices=new Array;var intr;var animateCounter=0;var newIndex;var firstDrop=true;var hideCounter=0;var g;var tempYOffset=270// JavaScript Document